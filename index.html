<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ & ‡∏™‡πà‡∏á LINE</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f6f7fb; }
    .card { border: none; border-radius: 1rem; box-shadow: 0 8px 30px rgba(0,0,0,.06); }
    .preview-img { max-height: 240px; object-fit: contain; border: 1px dashed #dee2e6; border-radius: .75rem; background: #fff; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .error { background-color: #f8d7da; color: #721c24; }
    .success { background-color: #d4edda; color: #155724; }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-xl-7">
        <div class="card p-4 p-md-5">
          <h1 class="h4 mb-3">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</h1>
          <!-- <p class="text-secondary mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á .NET API ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á LINE ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</p> -->

          <!-- (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ LIFF: ‡πÉ‡∏™‡πà userId ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ -->
          <div class="alert alert-info d-none" id="liffBox">
            <div class="d-flex align-items-center gap-2">
              <div class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></div>
              <strong>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå LIFF...</strong>
            </div>
          </div>

          <form id="uploadForm" class="needs-validation" novalidate>
            <div class="mb-3">
              <label for="slipFile" class="form-label">‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ (JPEG/PNG)</label>
              <input class="form-control" type="file" id="slipFile" accept="image/*" required>
              <div class="invalid-feedback">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ</div>
            </div>

            <div class="row g-3 align-items-start mb-3">
              <div class="col-md-6">
                <img id="preview" class="img-fluid preview-img w-100 d-none" alt="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ">
              </div>
              <!-- <div class="col-md-6">
                <label class="form-label">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á LINE (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)</label>
                <textarea id="lineText" class="form-control mono" rows="7"
                  placeholder="‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å .NET API ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á)"></textarea>

                <div class="form-text mt-2">
                  <strong>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö LINE:</strong>
                  <div class="input-group mt-1">
                    <span class="input-group-text">userId</span>
                    <input type="text" class="form-control" id="lineUserId" placeholder="‡πÉ‡∏™‡πà LINE userId ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ LIFF ‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ" />
                  </div>
                </div>
              </div> -->
            </div>

            <!-- <div class="mb-3">
              <div class="progress d-none" id="progressWrap" style="height: 10px;">
                <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" style="width:0%"></div>
              </div>
            </div> -->
            
            <div id="status"></div>

            <div class="d-grid gap-2"> 
            <!-- <div class="d-flex gap-2"> -->
              <button type="button" id="btnUpload" class="btn btn-primary">
                ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
              </button>
              <!-- <button type="button" id="btnSendLine" class="btn btn-success" disabled>
                ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE
              </button>
              <button type="button" id="btnReset" class="btn btn-outline-secondary">
                ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
              </button> -->
            </div>
          </form>

          <hr class="my-4">

          <!-- <div>
            <h2 class="h6">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å .NET API</h2>
            <pre id="apiResult" class="mono bg-light p-3 rounded small" style="white-space: pre-wrap;"></pre>
          </div> -->

          <!-- <div class="mt-3">
            <h2 class="h6">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h2>
            <div id="statusArea" class="small text-secondary">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
          </div> -->

        </div>

        <!-- <p class="text-center text-muted small mt-3">
          *‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏™‡πà LINE Channel Access Token ‡πÉ‡∏ô‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ß‡πá‡∏ö ‚Äî ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô backend ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        </p> -->

      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/versions/2.22.3/sdk.js"></script>
  <script>
    // =======================
    // üîß ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏∏‡∏ì
    // =======================
    // .NET API ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå (multipart/form-data) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏ú‡∏•
    //const API_UPLOAD_URL = "https://localhost:7136/extractSlip/extractTextFile"; // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

    // Backend endpoint ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà "proxy/push LINE"
    //const LINE_PUSH_URL  = "https://localhost:7136/line/push"; // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

    // (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) ‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ LIFF ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á userId ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà LIFF_ID ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤ block LIFF ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå
    // const USE_LIFF = false;
    // const LIFF_ID  = "YOUR_LIFF_ID";
    const id = "2008716446-QzCHty1r"; // -- log in extract slip
    const tokehslip = "81cae111-e8de-4266-b21c-1aa364d0ecfb";

    const profileName = null;
    const userIdLine = null;
    // =======================
    // ‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢ UI
    // =======================
    const $ = (s) => document.querySelector(s);
    const slipFile = $("#slipFile");
    const preview = $("#preview");
    const lineText = $("#lineText");
    const lineUserId = $("#lineUserId");
    const btnUpload = $("#btnUpload");
    const btnSendLine = $("#btnSendLine");
    const btnReset = $("#btnReset");
    const apiResult = $("#apiResult");
    const statusArea = $("#statusArea");
    const progressWrap = $("#progressWrap");
    const progressBar = $("#progressBar");

    main();

    async function main() {
            liff.init({ liffId: id }, function () {
                liff.ready.then(async () => {
                    // LIFF is ready
                    console.log('LIFF Started');

                    if (!liff.isLoggedIn()) {

                        liff.login();
                    }

                    var profile = await liff.getProfile();
                    const accessToken = await liff.getAccessToken();
                    const idToken = await liff.getIDToken();

                    console.log(profile);
                    console.log("Access Token : " + accessToken);
                    console.log("ID Token : " + idToken);

                    var name = profile.displayName;

                    console.log("Profile Name : " + profile.displayName);
                    console.log("User ID : " + profile.userId);

                    profileName = profile.displayName;
                    userIdLine = profile.userId;

                }).catch((err) => {
                    console.error('LIFF initialization failed ', err);
                });
            });
        }

    // function setStatus(msg, isErr = false) {
    //   statusArea.textContent = msg;
    //   statusArea.classList.toggle("text-danger", isErr);
    //   statusArea.classList.toggle("text-secondary", !isErr);
    // }

    // function setProgress(percent) {
    //   progressWrap.classList.remove("d-none");
    //   progressBar.style.width = `${percent}%`;
    //   if (percent >= 100) {
    //     setTimeout(() => progressWrap.classList.add("d-none"), 800);
    //   }
    // }

    // function resetAll() {
    //   $("#uploadForm").reset();
    //   preview.src = "";
    //   preview.classList.add("d-none");
    //   apiResult.textContent = "";
    //   lineText.value = "";
    //   btnSendLine.disabled = true;
    //   setProgress(0);
    //   progressWrap.classList.add("d-none");
    //   setStatus("‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô");
    // }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ
    slipFile.addEventListener("change", (e) => {
      const f = e.target.files?.[0];
      if (!f) { preview.classList.add("d-none"); return; }
      const url = URL.createObjectURL(f);
      preview.src = url;
      preview.onload = () => URL.revokeObjectURL(url);
      preview.classList.remove("d-none");
    });

    btnUpload.addEventListener("click", async () => {
        const f = slipFile.files?.[0];
        const statusDiv = document.getElementById('status');
        
        if (!f) {
            statusDiv.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î';
            statusDiv.className = 'error';
            //slipFile.focus();
            return;
        }

        statusDiv.className = '';
        btnUpload.disabled = true;
        // $("#uploadForm").reset();
        // preview.classList.add("d-none");

        try {
            const formData = new FormData();
            formData.append("file", f);

            const resp = await fetch(`https://developer.easyslip.com/api/v1/verify`, {
                method: "POST",
                headers: {
                    'Authorization': `Bearer ${tokehslip}`
                },
                body: formData
            });

            console.log(resp);

            if(resp.status !== 200){
                statusDiv.textContent = '‡∏™‡∏•‡∏¥‡∏õ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
                statusDiv.className = 'error';

                return;
            }

            const result = await resp.json();
            console.log(result);

            if(result.status !== 200)
            {
                statusDiv.textContent = 'QR Code ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                statusDiv.className = 'error';

                return;            
            }

            const rec = result.data.receiver.account.name.th
            console.log("receiver : " + rec);

            if(rec !== undefined || rec !== null || rec !== '')
            {
                if(rec.includes("KERRY"))
                {
                    const dataJson = { data: result, profileName: profileName, userIdLine: userIdLine };

                    console.log(dataJson);
                }
                else
                {
                    statusDiv.textContent = '‡∏™‡∏•‡∏¥‡∏õ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡∏≠‡∏á KERRY ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
                    statusDiv.className = 'error';

                    return;
                }
            }
            else
            {
                statusDiv.textContent = '‡∏™‡∏•‡∏¥‡∏õ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ IT Support';
                statusDiv.className = 'error';

                return;
            }

            // $("#uploadForm").reset();
            // preview.classList.add("d-none");
            // statusDiv.textContent = '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
            // statusDiv.className = 'success';

        } catch (err) {
            console.error(err);
            
            statusDiv.textContent = '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ' + (err?.message || err);
            statusDiv.className = 'error';
        }
        finally {

            setTimeout(() => { liff.closeWindow(); }, 500);
        }
    });

    // // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ .NET API
    // btnUpload.addEventListener("click", async () => {
    //   const f = slipFile.files?.[0];
    //   if (!f) {
    //     setStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î", true);
    //     slipFile.focus();
    //     return;
    //   }
    //   setStatus("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á .NET API ...");
    //   setProgress(15);
    //   btnUpload.disabled = true;

    //   try {
    //     const fd = new FormData();
    //     fd.append("file", f); // ‡∏ä‡∏∑‡πà‡∏≠ key ‡∏ù‡∏±‡πà‡∏á .NET ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö

    //     // tip: ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°
    //     // fd.append("someParam", "value");

    //     const resp = await fetch(API_UPLOAD_URL, {
    //       method: "POST",
    //       body: fd
    //     });

    //     setProgress(60);

    //     // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á text ‡πÅ‡∏•‡∏∞ json
    //     let text;
    //     let json;
    //     const contentType = resp.headers.get("content-type") || "";
    //     if (contentType.includes("application/json")) {
    //       json = await resp.json();
    //       text = JSON.stringify(json, null, 2);
    //     } else {
    //       text = await resp.text();
    //     }

    //     apiResult.textContent = text;
    //     setProgress(90);

    //     // ‡∏™‡∏Å‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á LINE (‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏° response ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    //     let summary = "";
    //     if (json) {
    //       // ‡πÇ‡∏Ñ‡∏£‡∏á‡πÅ‡∏ö‡∏ö ResultData { result:any, status:int, message:string }
    //       if (typeof json.message === "string" && json.message.trim() !== "") {
    //         summary = json.message;
    //       } else if (json.result && typeof json.result === "string") {
    //         summary = json.result;
    //       } else {
    //         summary = "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö:\n" + JSON.stringify(json, null, 2);
    //       }
    //     } else {
    //       summary = text || "‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)";
    //     }
    //     lineText.value = summary;
    //     btnSendLine.disabled = false;

    //     setProgress(100);
    //     setStatus("‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á LINE");
    //   } catch (err) {
    //     console.error(err);
    //     setStatus("‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: " + (err?.message || err), true);
    //   } finally {
    //     btnUpload.disabled = false;
    //   }
    // });

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ LINE (‡∏ú‡πà‡∏≤‡∏ô backend proxy)
    // btnSendLine.addEventListener("click", async () => {
    //   const userId = lineUserId.value.trim();
    //   const message = lineText.value.trim();

    //   if (!userId) { setStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà LINE userId (‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡πâ LIFF ‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)", true); lineUserId.focus(); return; }
    //   if (!message) { setStatus("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á LINE", true); lineText.focus(); return; }

    //   setStatus("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ LINE (‡∏ú‡πà‡∏≤‡∏ô backend)...");
    //   btnSendLine.disabled = true;

    //   try {
    //     const resp = await fetch(LINE_PUSH_URL, {
    //       method: "POST",
    //       headers: { "Content-Type": "application/json" },
    //       body: JSON.stringify({ to: userId, message })
    //     });

    //     const txt = await resp.text();
    //     apiResult.textContent = `LINE push response:\n${txt}`;
    //     setStatus(resp.ok ? "‡∏™‡πà‡∏á LINE ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" : "‡∏™‡πà‡∏á LINE ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", !resp.ok);
    //   } catch (err) {
    //     console.error(err);
    //     setStatus("‡∏™‡πà‡∏á LINE ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: " + (err?.message || err), true);
    //   } finally {
    //     btnSendLine.disabled = false;
    //   }
    // });

    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
    //btnReset.addEventListener("click", resetAll);

    // =======================
    // (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) ‡∏ú‡∏π‡∏Å LIFF ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ userId ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    // =======================
    // 1) ‡πÄ‡∏õ‡∏¥‡∏î USE_LIFF = true ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà LIFF_ID
    // 2) ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏ô‡πÉ‡∏ô LIFF context

    // if (USE_LIFF && typeof liff === "undefined") {
    //   // ‡πÇ‡∏´‡∏•‡∏î LIFF SDK ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
    //   const s = document.createElement("script");
    //   s.src = "https://static.line-scdn.net/liff/edge/2/sdk.js";
    //   s.onload = initLiff;
    //   document.body.appendChild(s);
    //   $("#liffBox").classList.remove("d-none");
    // } else if (USE_LIFF) {
    //   initLiff();
    // }

    // async function initLiff() {
    //   try {
    //     await liff.init({ liffId: LIFF_ID });
    //     if (!liff.isLoggedIn()) liff.login();
    //     const profile = await liff.getProfile();
    //     lineUserId.value = profile.userId || "";
    //     $("#liffBox").classList.add("d-none");
    //   } catch (e) {
    //     $("#liffBox").classList.remove("d-none");
    //     $("#liffBox").classList.replace("alert-info", "alert-warning");
    //     $("#liffBox").innerHTML = "<strong>LIFF ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</strong> " + (e?.message || e);
    //   }
    // }
  </script>
</body>
</html>
